---
title: "CEVE 543 Fall 2025 Pset 2"

author: Jonah Schaechter
date: "2025-11-18"
type: "Pset"
module: 2

engine: julia


format:
  html:
    toc: true
    toc-depth: 2
    code-block-bg: "#f8f8f8"
    code-block-border-left: "#e1e4e5"
    theme: simplex
    number-sections: true
    fig-format: svg
  typst:
    fontsize: 11pt
    margin:
      x: 1in
      y: 1in
    number-sections: true
    fig-format: svg

execute:
  cache: true
  freeze: auto

# Code formatting options
code-overflow: wrap
code-line-numbers: false
code-block-font-size: "0.85em"
---

## Background and Reading

This lab extends the weather typing analysis from Lab 8, replacing K-means clustering with Hidden Markov Models (HMMs).
While K-means treats each day independently, HMMs explicitly model temporal dependencies between consecutive weather patterns.
This is crucial for understanding weather persistence and transitions between regimes.

### Hidden Markov Models

An HMM consists of:

- **Hidden states**: Unobserved weather regimes (what we want to identify)
- **Observations**: PC scores we actually measure
- **Emission distributions**: How each state generates observations (multivariate normal in PC space)
- **Transition matrix**: Probabilities of switching between states from one day to the next
- **Initial distribution**: Probability of starting in each state

## Code Setup

Begin with project management:

```{julia}
#| output: false
using Pkg
lab_dir = dirname(@__FILE__)
Pkg.activate(lab_dir)
#Pkg.instantiate() # uncomment this the first time you run the lab to install packages, then comment it back
```

Load all required packages:

```{julia}
using YAXArrays
using NetCDF
using CairoMakie
using GeoMakie
using MultivariateStats
using Statistics
using LaTeXStrings
using DimensionalData
using NaturalEarth
using HiddenMarkovModels
using Distributions
using Random
using Dates
using LinearAlgebra: diag
```

